/*
 Hype TextPath Extension
 Copyright (2019-2024) Max Ziebell, (https://maxziebell.de). MIT-license
*/
'use strict';!1==="HypeTextPath"in window&&(window.HypeTextPath=function(){function t(a){a.querySelectorAll("[data-text-path] text").forEach(function(c){c.parentElement.removeChild(c)})}function m(a){g&&t(a);a.querySelectorAll("[data-text-path]").forEach(function(c){var b=c.dataset.textPath;b&&(c=c.querySelector("svg"),k(c,a,b))});g&&u(a)}function k(a,c,b){b=c.querySelector('[data-text-content="'+b+'"]');c=a.querySelector("path");if(b&&c){var d=a.querySelector("text");d&&d.parentElement.removeChild(d);
g||(c.style.opacity=0,b.style.opacity=0,c.style.pointerEvents="none");d=document.createElementNS("http://www.w3.org/2000/svg","text");var e=document.createElementNS("http://www.w3.org/2000/svg","textPath");d.appendChild(e);e.textContent=b.querySelector("innerhtmldiv")?b.querySelector("innerhtmldiv").textContent:b.textContent||b.innerText;n(b,d);b=parseInt(d.style.fontSize);a.style.setProperty("padding",b+"px","important");a.style.setProperty("margin-left","-"+b+"px","important");a.style.setProperty("margin-top",
"-"+b+"px","important");a.style.setProperty("overflow","visible","important");e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href","#"+c.id);e.setAttribute("href","#"+c.id);p(c,e);a.appendChild(d);g&&(d.style.pointerEvents="none",d.style.webkitUserSelect="none",e.style.pointerEvents="none",e.style.webkitUserSelect="none");v(c,e)}}function n(a,c){["fontFamily","fontSize",["color","fill"],"letterSpacing","wordSpacing"].forEach(function(b){var d=Array.isArray(b);c.style[d?b[1]:b]=a.style[d?b[0]:
b]})}function p(a,c){if("string"===typeof a.getAttribute("stroke-dasharray")){var b=Number(a.getAttribute("stroke-dashoffset"));a=a.getTotalLength();c.setAttribute("startOffset",(100*(1-b/a)).toFixed(2)+"%")}}function v(a,c){var b=new MutationObserver(function(d){d.forEach(function(e){"attributes"===e.type&&"stroke-dashoffset"===e.attributeName&&p(e.target,c)})});b.observe(a,{attributes:!0,attributeFilter:["stroke-dashoffset"]});l.set(a,b)}function u(a){(new MutationObserver(function(c){c.forEach(function(b){var d=
b.target;if("attributes"===b.type){var e=d.dataset.textPath||d.dataset.textContent;b.oldValue&&w(a,b.oldValue);if(e){const f=a.querySelector(`[data-text-path="${e}"] svg`);f&&k(f,a,e)}}"data-text-content"===b.attributeName&&q(a,d);"childList"===b.type&&(b.addedNodes.forEach(f=>{if(1===f.nodeType&&(f.dataset.textPath||f.dataset.textContent)){var h=f.dataset.textPath||f.dataset.textContent;f=f.querySelector("svg");k(f,a,h)}}),b.removedNodes.forEach(f=>{1===f.nodeType&&f.querySelectorAll("path").forEach(h=>
{var r=l.get(h);r&&(r.disconnect(),l.delete(h))})}));d.classList.contains("HYPE_InnerHTML_Div")&&(e=d.closest("[data-text-content]")?.dataset.textContent)&&q(a,d.closest("[data-text-content]"));"style"===b.attributeName&&(e=d.closest("[data-text-content]")?.dataset.textContent)&&(b=d.closest("[data-text-content]"),e=a.querySelector(`[data-text-path="${e}"] text`),b&&e&&n(b,e))})})).observe(a,{attributes:!0,subtree:!0,attributeOldValue:!0,attributeFilter:["data-text-path","data-text-content","stroke-dashoffset",
"style"],childList:!0,characterData:!0})}function q(a,c){var b=c.dataset.textContent,d=c.querySelector("innerhtmldiv");c=d?d.textContent:c.textContent||c.innerText;if(a=a.querySelector(`[data-text-path="${b}"] textPath`))a.textContent=c}function w(a,c){(a=a.querySelector(`[data-text-path="${c}"] textPath`))&&a.parentElement.removeChild(a)}const g=-1!=window.location.href.indexOf("/Hype/Scratch/HypeScratch."),l=new WeakMap;!1==="HYPE_eventListeners"in window&&(window.HYPE_eventListeners=[]);window.HYPE_eventListeners.push({type:"HypeSceneLoad",
callback:function(a,c,b){m(c)}});g&&document.addEventListener("DOMContentLoaded",function(){setTimeout(function(){m(document.body)},100)});return{version:"1.1.2"}}());
