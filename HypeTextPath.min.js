/*
 Hype TextPath Extension
 Copyright (2019-2024) Max Ziebell, (https://maxziebell.de). MIT-license
*/
'use strict';!1==="HypeTextPath"in window&&(window.HypeTextPath=function(){function r(a){a.querySelectorAll("[data-text-path] textPath").forEach(function(b){b.parentElement.removeChild(b)})}function m(a){g&&r(a);a.querySelectorAll("[data-text-path]").forEach(function(b){var c=b.dataset.textPath;c&&(b=b.querySelector("svg"),k(b,a,c))});g&&t(a)}function k(a,b,c){var d=b.querySelector('[data-text-content="'+c+'"]');b=a.querySelector("path");if(d&&b){g||(b.style.opacity=0,d.style.opacity=0,b.style.pointerEvents=
"none");c=document.createElementNS("http://www.w3.org/2000/svg","text");var e=document.createElementNS("http://www.w3.org/2000/svg","textPath");c.appendChild(e);e.textContent=d.querySelector("innerhtmldiv")?d.querySelector("innerhtmldiv").textContent:d.textContent||d.innerText;u(d,c);d=parseInt(c.style.fontSize);a.style.setProperty("padding",d+"px","important");a.style.setProperty("margin-left","-"+d+"px","important");a.style.setProperty("margin-top","-"+d+"px","important");a.style.setProperty("overflow",
"visible","important");e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href","#"+b.id);e.setAttribute("href","#"+b.id);n(b,e);a.appendChild(c);g&&(c.style.pointerEvents="none",c.style.webkitUserSelect="none",e.style.pointerEvents="none",e.style.webkitUserSelect="none");v(b,e)}}function u(a,b){["fontFamily","fontSize",["color","fill"],"letterSpacing","wordSpacing"].forEach(function(c){var d=Array.isArray(c);b.style[d?c[1]:c]=a.style[d?c[0]:c]})}function n(a,b){if("string"===typeof a.getAttribute("stroke-dasharray")){var c=
Number(a.getAttribute("stroke-dashoffset"));a=a.getTotalLength();b.setAttribute("startOffset",(100*(1-c/a)).toFixed(2)+"%")}}function v(a,b){var c=new MutationObserver(function(d){d.forEach(function(e){"attributes"===e.type&&"stroke-dashoffset"===e.attributeName&&n(e.target,b)})});c.observe(a,{attributes:!0,attributeFilter:["stroke-dashoffset"]});l.set(a,c)}function t(a){(new MutationObserver(function(b){b.forEach(function(c){var d=c.target;if("attributes"===c.type){var e=d.dataset.textPath||d.dataset.textContent;
c.oldValue&&w(a,c.oldValue);if(e){const f=a.querySelector(`[data-text-path="${e}"] svg`);f&&k(f,a,e)}}"data-text-content"===c.attributeName&&p(a,d);"childList"===c.type&&(c.addedNodes.forEach(f=>{if(1===f.nodeType&&(f.dataset.textPath||f.dataset.textContent)){var h=f.dataset.textPath||f.dataset.textContent;f=f.querySelector("svg");k(f,a,h)}}),c.removedNodes.forEach(f=>{1===f.nodeType&&f.querySelectorAll("path").forEach(h=>{var q=l.get(h);q&&(q.disconnect(),l.delete(h))})}));d.classList.contains("HYPE_InnerHTML_Div")&&
(e=d.closest("[data-text-content]")?.dataset.textContent)&&p(a,d.closest("[data-text-content]"))})})).observe(a,{attributes:!0,subtree:!0,attributeOldValue:!0,attributeFilter:["data-text-path","data-text-content","stroke-dashoffset"],childList:!0,characterData:!0})}function p(a,b){var c=b.dataset.textContent,d=b.querySelector("innerhtmldiv");b=d?d.textContent:b.textContent||b.innerText;if(a=a.querySelector(`[data-text-path="${c}"] textPath`))a.textContent=b}function w(a,b){(a=a.querySelector(`[data-text-path="${b}"] textPath`))&&
a.parentElement.removeChild(a)}const g=-1!=window.location.href.indexOf("/Hype/Scratch/HypeScratch."),l=new WeakMap;!1==="HYPE_eventListeners"in window&&(window.HYPE_eventListeners=[]);window.HYPE_eventListeners.push({type:"HypeSceneLoad",callback:function(a,b,c){m(b)}});g&&document.addEventListener("DOMContentLoaded",function(){setTimeout(function(){m(document.body)},100)});return{version:"1.1.1"}}());
